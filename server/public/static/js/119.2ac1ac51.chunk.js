"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[119],{7119:function(e,n,t){t.r(n),t.d(n,{default:function(){return ae}});var r=t(2791),s=t(586),o=t(1694),a=t.n(o),i=t(7689),c=t(9434),l=t(706),u=t(43),d=t(184),f=function(){return(0,d.jsx)("div",{className:"w-full flex flex-col items-center h-[calc(100vh_-_120px)]",children:(0,d.jsx)(u.Z,{className:"mt-2",size:"large"})})},p=t(9439),x=t(5820),m=t(3388),h=t(1990),v=t(9389),g=t(7828),j=t(3621),Z=t(2622),w=t(1752),y=t(2056),b=t(732),N=t(1977),k=t(1708),C=t(4165),I=t(5861),S=t(7473),P=t.n(S),E=t(9286),D=t(6776),F=t(7846),L=t(5518),_=function(){var e=F.Z.useForm(),n=(0,p.Z)(e,1)[0],t=(0,r.useState)([]),s=(0,p.Z)(t,2),o=s[0],a=s[1],i=(0,r.useState)(!1),l=(0,p.Z)(i,2),f=l[0],x=l[1],m=(0,c.I0)(),g=(0,c.v9)((function(e){return e.source.uploading}));(0,c.v9)((function(e){return e.source.uploadingError}));return(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsxs)("button",{className:"bg-transparent text-white border border-white border-dashed hover:border-indigo-500 font-bold uppercase text-sm rounded shadow hover:shadow-lg outline-none focus:outline-none m-2 ease-linear transition-all duration-150 px-12 py-3 cursor-pointer flex items-center",type:"button",onClick:function(){return x(!0)},children:[!g&&(0,d.jsx)(E.Z,{className:"text-white mr-1"}),g&&(0,d.jsx)(u.Z,{size:"small",className:"mr-1"}),"Add Property"]}),(0,d.jsx)(h.Z,{open:f,title:"Add a property",okText:"Upload",cancelText:"Cancel",onCancel:function(){return x(!1)},onOk:function(){n.validateFields().then(function(){var e=(0,I.Z)((0,C.Z)().mark((function e(t){var r,s,o;return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.propertyName,s=t.dragger.fileList,(o=new(P())).append("sourceName",r),s.forEach((function(e){var n=e.originFileObj;o.append("files",n)})),m((0,N.Ke)(o)),n.resetFields(),a([]),x(!1);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log("Validate Failed:",e)}))},okButtonProps:{loading:g},children:(0,d.jsxs)(F.Z,{form:n,layout:"vertical",children:[(0,d.jsx)(F.Z.Item,{name:"propertyName",label:"Property Name",rules:[{required:!0,message:"Please input the name of property"}],children:(0,d.jsx)(v.Z,{})}),(0,d.jsx)(F.Z.Item,{name:"dragger",label:"dragger",noStyle:!0,children:(0,d.jsxs)(L.Z.Dragger,{name:"files",beforeUpload:function(){return!1},accept:"application/pdf",fileList:o,multiple:!0,maxCount:5,onChange:function(e){var n=e.fileList.filter((function(e){return"application/pdf"===e.type}));a(n)},children:[(0,d.jsx)("p",{className:"ant-upload-drag-icon",children:(0,d.jsx)(D.Z,{})}),(0,d.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})]})})]})},O=t(7027),T=t(9660),A=t(8185),V=t(2774),R=t(8300),z=t(7620),K=function(e){var n=e.open,t=e.onClose,s=F.Z.useForm(),o=(0,p.Z)(s,1)[0],a=(0,r.useState)([]),i=(0,p.Z)(a,2),l=i[0],u=i[1],f=(0,c.I0)(),x=(0,c.v9)((function(e){return e.document.loading})),m=(0,c.v9)((function(e){return e.app.selectedSource}));(0,c.v9)((function(e){return e.source.uploadingError}));return(0,d.jsx)(h.Z,{open:n,title:"Add a Documents",okText:"Upload",cancelText:"Cancel",onCancel:function(){return t()},onOk:function(){o.validateFields().then(function(){var e=(0,I.Z)((0,C.Z)().mark((function e(n){var r,s;return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.dragger.fileList,(s=new(P())).append("sourceId",m),r.forEach((function(e){var n=e.originFileObj;s.append("files",n)})),f((0,V.iG)(s)),o.resetFields(),u([]),t();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log("Validate Failed:",e)}))},okButtonProps:{loading:!!x},children:(0,d.jsx)(F.Z,{form:o,layout:"vertical",children:(0,d.jsx)(F.Z.Item,{name:"dragger",label:"dragger",noStyle:!0,children:(0,d.jsxs)(L.Z.Dragger,{name:"files",beforeUpload:function(){return!1},accept:"application/pdf",fileList:l,multiple:!0,maxCount:5,onChange:function(e){var n=e.fileList.filter((function(e){return"application/pdf"===e.type}));u(n)},children:[(0,d.jsx)("p",{className:"ant-upload-drag-icon",children:(0,d.jsx)(D.Z,{})}),(0,d.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})})})},U=function(){var e=(0,c.v9)((function(e){return e.source.loading})),n=((0,c.v9)((function(e){return e.source.error})),(0,c.v9)((function(e){return e.source.sources}))),t=(0,c.v9)((function(e){return e.document.documents})),s=(0,c.v9)((function(e){return e.document.loading})),o=(0,c.I0)(),a=(0,c.v9)((function(e){return e.app.selectedSource})),i=(0,r.useState)(!1),l=(0,p.Z)(i,2),f=l[0],x=l[1],h=n.map((function(e,n){var r=e.name,o=e.sourceId,a=t.filter((function(e){return e.sourceId===o})).map((function(e){return(0,R.rV)(e.name,"".concat(e._id),(0,d.jsx)(T.Z,{}),null,!0)}));return a.push((0,R.rV)("Add Document","addDocument-".concat(n,"-").concat(o),s==o?(0,d.jsx)(u.Z,{size:"small"}):(0,d.jsx)(E.Z,{}),null)),a.length>0?(0,R.rV)(r,"".concat(o),(0,d.jsx)(A.fmc,{}),a):(0,R.rV)(r,"".concat(o),(0,d.jsx)(A.fmc,{}))}));if((0,r.useEffect)((function(){o((0,N.e6)()),o((0,V.qi)())}),[]),(0,r.useEffect)((function(){var e,t=(0,R.cF)("latestKey")||(null===(e=n[0])||void 0===e?void 0:e.sourceId);t&&o((0,z.P)({sourceId:t}))}),[n]),e)return(0,d.jsx)("div",{className:"text-center text-gray-400",children:"Loading..."});return(0,d.jsxs)("div",{children:[(0,d.jsx)(m.Z,{openKeys:["".concat(a)],onOpenChange:function(e){if(!(e.length<2)){var n=e[e.length-1];o((0,z.P)({sourceId:n})),(0,R.po)("latestKey",n)}},mode:"inline",theme:"dark",items:h,selectable:!1,onClick:function(e){if(e.key.startsWith("addDocument")){if(s)return O.ZP.warning("Server is busy now. Please wait a moment...");x(!0)}}}),(0,d.jsx)(K,{open:f,onClose:function(){return x(!1)}})]})},q=(s.Z.Sider,function(){return(0,d.jsx)(U,{})}),B=function(){var e=(0,i.TH)(),n=(0,c.I0)(),t=((0,c.v9)((function(e){return e.source.deleting})),(0,c.v9)((function(e){return e.source.renaming})),(0,c.v9)((function(e){return e.source.reseting})),(0,c.v9)((function(e){return e.app.selectedSource}))),s=(0,r.useState)(!1),o=(0,p.Z)(s,2),a=o[0],u=o[1],f=(0,r.useState)(!1),C=(0,p.Z)(f,2),I=C[0],S=C[1],P=(0,r.useState)(""),E=(0,p.Z)(P,2),D=E[0],F=E[1],L=[{title:"Open Documents",label:(0,d.jsx)("span",{className:"cursor-pointer inline-block px-1 hover:text-[#40a9ff]",children:(0,d.jsx)(j.Z,{className:"!text-[18px]"})}),className:"!inline sm:!hidden",onClick:function(){S(!0)}},{title:"Delete Property",label:(0,d.jsx)(x.Z,{placement:"bottomLeft",description:"Are you sure you want to delete this property?",onConfirm:function(e){e.preventDefault(),n((0,N.JN)({sourceId:t}))},okText:"Yes",okButtonProps:{className:"bg-red-600 hover:!bg-red-500 text-white"},cancelText:"No",icon:!1,children:(0,d.jsx)("span",{className:"cursor-pointer inline-block px-1 hover:text-[#40a9ff]",children:(0,d.jsx)(Z.Z,{className:"!text-[18px]"})})})},{title:"Rename Property",label:(0,d.jsx)("span",{className:"cursor-pointer inline-block px-1 hover:text-[#40a9ff]",children:(0,d.jsx)(w.Z,{className:"!text-[18px]"})}),onClick:function(){u(!0)}},{title:"Reset chat history",label:(0,d.jsx)("span",{className:"cursor-pointer inline-block px-1 hover:text-[#40a9ff]",children:(0,d.jsx)(y.Z,{className:"!text-[18px]"})}),onClick:function(){n((0,l.qP)({sourceId:t}))}}];return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between flex-wrap p-1 shadow",children:[(0,d.jsx)(m.Z,{mode:"horizontal",className:"w-1/2 border-0",selectable:!1,items:L}),(0,d.jsx)("div",{className:"w-1/2 flex justify-end pr-2",children:"/home"==e.pathname&&(0,d.jsx)(k.Z,{})})]}),(0,d.jsx)(h.Z,{title:"Rename Property",style:{top:"10%"},open:a,onOk:function(){n((0,N.d4)({name:D,sourceId:t})),F(""),u(!1)},onCancel:function(){return u(!1)},okButtonProps:{className:"bg-blue-600"},children:(0,d.jsx)(v.Z,{placeholder:"Input property name...",className:"mt-2",onChange:function(e){F(e.target.value)},value:D})}),(0,d.jsxs)(g.Z,{title:"",width:250,placement:"left",style:{backgroundColor:"#001529",color:"#fff"},bodyStyle:{padding:0},onClose:function(){S(!1)},open:I,closeIcon:(0,d.jsx)(b.Z,{style:{color:"#fff"}}),children:[(0,d.jsx)(_,{}),(0,d.jsx)(q,{})]})]})},G=t(3099),H=t(7309),M=t(3097),W=function(){var e=(0,c.I0)(),n=(0,c.v9)((function(e){return e.message.waiting})),t=((0,c.v9)((function(e){return e.message.promptError})),(0,c.v9)((function(e){return e.app.selectedSource}))),s=(0,c.v9)((function(e){return e.source.sources.length>0})),o=(0,r.useState)(""),a=(0,p.Z)(o,2),i=a[0],u=a[1],f=(0,r.useRef)(null),x=function(r){if(r.preventDefault(),!n&&i){var s=i.trim();e((0,l.bG)({sourceId:t,text:s,isChatOwner:!0})),u("")}};return(0,r.useEffect)((function(){var e;s&&!n&&(null===(e=f.current)||void 0===e||e.focus())}),[s,n]),(0,d.jsx)("div",{className:"py-3 bg-white w-full mx-auto max-w-3xl px-2",children:(0,d.jsxs)(G.Z.Compact,{style:{width:"100%"},size:"large",children:[(0,d.jsx)(v.Z,{allowClear:!0,placeholder:n?"Waiting for response...":"Ask any question.",onKeyDown:function(e){"Enter"===e.key&&i?x(e):"Enter"==e.key&&e.preventDefault()},value:i,onChange:function(e){return u(e.target.value)},ref:f,disabled:!s||n}),(0,d.jsx)(H.ZP,{type:"primary",icon:(0,d.jsx)(M.Z,{}),onClick:x,disabled:!s||n})]})})},J=t(4664),Y=function(){return(0,d.jsx)("div",{className:"flex-1 w-full flex flex-col items-center h-[calc(100vh_-_120px)]",children:(0,d.jsx)(J.Z,{image:J.Z.PRESENTED_IMAGE_SIMPLE})})},Q=t(3218),X=function(){return(0,d.jsx)("div",{className:"px-3 py-2 flex flex-row w-full justify-start",children:(0,d.jsx)("div",{className:"px-3 py-2 w-fit lg:max-w-lg flex flex-col  rounded-lg  shadow-slate-200 shadow-sm  text-sm",children:(0,d.jsx)(u.Z,{})})})},$=t(4048),ee=function(e){var n=e.message;return(0,d.jsx)($.rf,{words:[n],typeSpeed:35})},ne=function(e){var n=e.message,t=e.isLast,r=e.onClick,s=n.text,o=n.isChatOwner,a=!!n.stream&&t;return(0,d.jsx)("div",{className:"px-3 py-2 flex flex-row w-full ".concat(o?"justify-end":"justify-start"),onClick:r,children:(0,d.jsx)("div",{className:"px-3 py-2 w-fit lg:max-w-lg flex flex-col  rounded-lg  shadow-slate-200 shadow-sm whitespace-pre-wrap cursor-pointer text-sm \n                ".concat(o?"order-1  bg-[#1677ff] text-white":"order-2  bg-gray-200  text-gray-800"),children:a?(0,d.jsx)(ee,{className:"whitespace-pre-wrap",message:s}):s})})},te=function(e){var n=e.messages,t=(0,r.useRef)(null),s=(0,c.v9)((function(e){return e.message.waiting})),o=(0,c.v9)((function(e){return e.auth.user})),a=(0,r.useState)(!1),i=(0,p.Z)(a,2),l=i[0],u=i[1],f=(0,r.useState)([]),x=(0,p.Z)(f,2),m=x[0],h=x[1];return(0,r.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[n]),(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:"flex flex-1 w-full overflow-auto justify-center h-[calc(100vh_-_120px)]",children:(0,d.jsxs)("div",{className:"w-full max-w-3xl",children:[n.map((function(e,t){return(0,d.jsx)(ne,{message:e,isLast:n.length===t+1,onClick:function(){return function(e){o.isAdmin&&(h(e.sourceDocuments),u(!0))}(e)}},t)})),s&&(0,d.jsx)(X,{}),(0,d.jsx)("div",{ref:t}),(0,d.jsx)(g.Z,{title:"Sources Documents",width:350,placement:"right",onClose:function(){u(!1)},open:l,children:(0,d.jsx)(G.Z,{direction:"vertical",children:m.map((function(e,n){return(0,d.jsx)(Q.Z,{title:"Document ".concat(n+1),children:(0,d.jsx)("p",{children:e.pageContent})},n)}))})})]})})})},re=function(){var e=(0,i.TH)(),n=(0,c.I0)(),t=(0,c.v9)((function(e){return e.message.loading})),s=((0,c.v9)((function(e){return e.message.error})),(0,c.v9)((function(e){return e.message.messages}))||[]),o=(0,c.v9)((function(e){return e.app.selectedSource}));return(0,r.useEffect)((function(){o&&n((0,l._U)({sourceId:o}))}),[o]),(0,d.jsx)("div",{className:"max-w-full mx-auto",children:(0,d.jsxs)("div",{className:a()("bg-white",{"h-screen":"/home"==e.pathname}),children:[(0,d.jsx)(B,{}),t&&(0,d.jsx)(f,{}),!t&&s.length>0?(0,d.jsx)(te,{messages:s}):(0,d.jsx)(Y,{}),(0,d.jsx)(W,{})]})})},se=s.Z.Content,oe=s.Z.Sider;var ae=function(){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(oe,{theme:"dark",width:250,className:"hidden sm:block",style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:[(0,d.jsx)(_,{}),(0,d.jsx)(q,{})]}),(0,d.jsx)(s.Z,{className:"sm:ml-[250px] max-h-screen",children:(0,d.jsx)(se,{children:(0,d.jsx)(re,{})})})]})}}}]);
//# sourceMappingURL=119.2ac1ac51.chunk.js.map